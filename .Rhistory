Gv=parabolicdiff(G,7)*samplerate, #calculate velocity
Hv=parabolicdiff(H,7)*samplerate,
# gazeshifts=markMovementsDouble(Gv,threshold1=100,threshold2=10),
gazeshifts=markSaccadesDouble(Gv,threshold1=100,threshold2=20,
driftcorrect = TRUE,markFixations = FALSE),
headmovement=markMovementsDouble(Hv,threshold1=10,threshold2=4)) %>%
do(markTagetMovements(t=.,buffer=200,threshold=200,trial.length=500))%>%
filter(!is.na(trialnum))->
htest
htest %>%
filter(!is.na(trialnum)) %>%
group_by(task,subject,block,trialnum) %>%
do(measureTrial(.))->
hm
hplot<-filter(hm,missing.gs<5)
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<5))+facet_wrap(~block)
ggplot(hplot)+
geom_point(aes(post.saccade.head,post.saccade.drift,color=block))
ggplot(filter(hplot,abs(post.saccade.head)>5),
aes(abs(post.saccade.head),abs(post.saccade.drift),color=block))+
geom_point()+
stat_smooth(method='lm',se=FALSE)+
geom_abline()
ggplot(filter(hplot,abs(post.saccade.head)>5),
aes(post.saccade.head,post.saccade.drift,color=block))+
geom_point()+
stat_smooth(se=FALSE)
drifters<-filter(hplot,abs(post.saccade.drift)>10,abs(post.saccade.head)>10)
drifters<-select(ungroup(drifters),block,trialnum,post.saccade.head,post.saccade.drift,gaze.offset)
ggplot(drifters)+
geom_point(aes(post.saccade.head,post.saccade.drift,color=block))+
geom_abline()
ggplot(drifters,aes(abs(post.saccade.head),abs(post.saccade.drift),color=block))+
geom_point()+
geom_abline()+
stat_smooth(method='lm',se=FALSE)
ggplot(hplot,aes(abs(post.saccade.head),abs(post.saccade.drift),color=block))+
geom_point()+
geom_abline()+
stat_smooth(method='lm',se=FALSE)
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=block))+
geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)
saveRDS(hplot,'DemoVORxL16ST6-calib2.RDS)
saveRDS(hplot,'DemoVORxL16ST6-calib2.RDS')
saveRDS(htest,'DemoVORxL16ST6-calib2.RDS')
# path<- "F:/dropbox/kdata/anti/"
path<- "C:/users/setup/dropbox/kdata/"
h<-loadnewheadfree(path=path)
h%>%
select(G,H,Targ,block,subject,task)%>%
group_by(block) %>%
filter(!is.na(G)) %>%
mutate(time=row_number(),
Graw=G,
G=replace(smooth(G,"3R"),G==0,NA), #mark missing data as NA rather than 0
Gnospline=G,
G= applyspline(G,6),
target.velocity=parabolicdiff(Targ,7)*samplerate,
Gv=parabolicdiff(G,7)*samplerate, #calculate velocity
Hv=parabolicdiff(H,7)*samplerate,
# gazeshifts=markMovementsDouble(Gv,threshold1=100,threshold2=10),
gazeshifts=markSaccadesDouble(Gv,threshold1=100,threshold2=20,
driftcorrect = TRUE,markFixations = FALSE),
headmovement=markMovementsDouble(Hv,threshold1=10,threshold2=4)) %>%
do(markTagetMovements(t=.,buffer=200,threshold=200,trial.length=500))%>%
filter(!is.na(trialnum))->
h
unique(h$block)
h%>%
select(G,H,Targ,block,subject,task)%>%
group_by(block) %>%
filter(!is.na(G)) %>%
mutate(time=row_number(),
Graw=G,
G=replace(smooth(G,"3R"),G==0,NA), #mark missing data as NA rather than 0
Gnospline=G,
G= applyspline(G,6),
target.velocity=parabolicdiff(Targ,7)*samplerate,
Gv=parabolicdiff(G,7)*samplerate, #calculate velocity
Hv=parabolicdiff(H,7)*samplerate,
# gazeshifts=markMovementsDouble(Gv,threshold1=100,threshold2=10),
gazeshifts=markSaccadesDouble(Gv,threshold1=100,threshold2=20,
driftcorrect = TRUE,markFixations = FALSE),
headmovement=markMovementsDouble(Hv,threshold1=10,threshold2=4)) %>%
do(markTagetMovements(t=.,buffer=200,threshold=200,trial.length=500))%>%
filter(!is.na(trialnum))->
h
#measure trials join to previous table if needed
h %>%
filter(!is.na(trialnum)) %>%
group_by(task,subject,block,trialnum) %>%
do(measureTrial(.))->
hm
saveRDS(h,'DriftTest1.RDS')
hplot<-filter(hm,missing.gs<5)
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<5))+facet_wrap(~block)
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<5))+facet_wrap(~block)+
geom_vline(xintercept = -1)
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<5))+
facet_wrap(~block,ncol=4)+
geom_vline(xintercept = -1)
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<5))+
facet_wrap(~block,ncol=4)+
geom_vline(xintercept = -1)+
xlab('VOR gain')
ggplot(filter(hplot,abs(post.saccade.VOR)<5))+
geom_boxplot(aes(blocknum,post.saccade.VOR,fill=block))+
facet_wrap(~subject)
names(hplot)
ggplot(filter(hplot,abs(post.saccade.VOR)<5))+
geom_boxplot(aes(block,post.saccade.VOR,fill=block))+
facet_wrap(~subject)
ggplot(filter(hplot,abs(post.saccade.VOR)<5))+
geom_boxplot(aes(block,post.saccade.VOR,fill=block))+
facet_wrap(~subject,axes='free')
ggplot(filter(hplot,abs(post.saccade.VOR)<5))+
geom_boxplot(aes(block,post.saccade.VOR,fill=block))+
facet_wrap(~subject,scales='free')
ggplot(filter(hplot,abs(post.saccade.VOR)<5))+
geom_boxplot(aes(block,post.saccade.VOR,fill=block))+
facet_wrap(~subject,scales='free',ncol=4)+
theme(legend.position='none')
ggplot(filter(hplot,abs(post.saccade.VOR)<5))+
geom_boxplot(aes(block,post.saccade.VOR,fill=block))+
facet_wrap(~subject,scales='free',ncol=4)+
geom_hline(yintercept = -1)
ggplot(filter(hplot,abs(post.saccade.VOR)<5))+
geom_boxplot(aes(block,post.saccade.VOR,fill=block))+
facet_wrap(~subject,scales='free',ncol=4)+
geom_hline(yintercept = -1,color='red')
ggplot(filter(hplot,abs(post.saccade.VOR)<5))+
geom_boxplot(aes(block,post.saccade.VOR,fill=block))+
facet_wrap(~subject,scales='free',ncol=4)+
geom_hline(yintercept = -1,color='red')+
theme(legend.position='none')
ggplot(filter(hplot,abs(post.saccade.VOR)<5))+
geom_boxplot(aes(block,post.saccade.VOR,fill=block))+
facet_wrap(~subject,scales='free',ncol=3)+
geom_hline(yintercept = -1,color='red')+
theme(legend.position='none')
```{r,fig.height=6}
ggplot(filter(hplot,abs(post.saccade.VOR)<5))+
geom_boxplot(aes(block,post.saccade.VOR,fill=block))+
facet_wrap(~subject,scales='free',ncol=3)+
geom_hline(yintercept = -1,color='red')+
theme(legend.position='none')
ggplot(filter(hplot,abs(post.saccade.VOR)<5))+
geom_boxplot(aes(block,post.saccade.VOR,fill=block))+
facet_wrap(~subject,scales='free',ncol=3)+
geom_hline(yintercept = -1,color='red',alpha=0.5)+
theme(legend.position='none')
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<5))+
facet_wrap(~block,ncol=4)+
geom_vline(xintercept = -1)+
xlab('VOR gain')
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<5))+
facet_wrap(~block,ncol=4)+
geom_vline(xintercept = -1)+
xlab('VOR gain')
ggplot(filter(hplot,abs(post.saccade.VOR)<5))+
geom_boxplot(aes(block,post.saccade.VOR,fill=block))+
facet_wrap(~subject,scales='free',ncol=3)+
geom_hline(yintercept = -1,color='red',alpha=0.5)+
theme(legend.position='none')
ggplot(filter(hplot,abs(post.saccade.VOR)<5))+
geom_boxplot(aes(block,post.saccade.VOR,fill=block))+
facet_wrap(~subject,scales='free',ncol=3)+
geom_hline(yintercept = -1,color='red',alpha=0.5)+
theme(legend.position='none')
ggplot(filter(hplot,abs(post.saccade.VOR)<3))+
geom_boxplot(aes(block,post.saccade.VOR,fill=block))+
facet_wrap(~subject,scales='free',ncol=3)+
geom_hline(yintercept = -1,color='red',alpha=0.5)+
theme(legend.position='none')
ggplot(hplot)+
geom_point(aes(post.saccade.head,post.saccade.drift,color=block))
ggplot(filter(hplot,abs(post.saccade.head)>5),
aes(abs(post.saccade.head),abs(post.saccade.drift),color=block))+
geom_point()+
stat_smooth(method='lm',se=FALSE)+
geom_abline()
ggplot(filter(hplot,abs(post.saccade.head)>5),
aes(post.saccade.head,post.saccade.drift,color=block))+
geom_point()+
stat_smooth(se=FALSE)
drifters<-filter(hplot,abs(post.saccade.drift)>10,abs(post.saccade.head)>10)
drifters<-select(ungroup(drifters),block,trialnum,post.saccade.head,post.saccade.drift,gaze.offset)
ggplot(drifters)+
geom_point(aes(post.saccade.head,post.saccade.drift,color=block))+
geom_abline()
ggplot(drifters,aes(abs(post.saccade.head),abs(post.saccade.drift),color=block))+
geom_point()+
geom_abline()+
stat_smooth(method='lm',se=FALSE)
ggplot(hplot,aes(abs(post.saccade.head),abs(post.saccade.drift),color=block))+
geom_point()+
geom_abline()+
stat_smooth(method='lm',se=FALSE)
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=block))+
geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=block))+
geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)+
facet_wrap(~subject,ncol=3,scales='free')
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=block))+
geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)+
facet_wrap(~subject,ncol=3,scales='free')
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=block))+
geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)+
facet_wrap(~subject,ncol=2,scales='free')+
theme(legend.position='none')
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=block))+
geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)+
facet_wrap(~subject,ncol=2,scales='free')+
theme(legend.position='none')
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=block))+
# geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)+
facet_wrap(~subject,ncol=2,scales='free')+
theme(legend.position='none')
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=block))+
# geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)+
facet_wrap(~subject,ncol=4,scales='free')+
theme(legend.position='none')
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=block))+
# geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)+
facet_wrap(~subject,ncol=4,scales='free')+
theme(legend.position='none')
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=block))+
# geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)+
facet_wrap(~subject,ncol=4,scales='free')+
theme(legend.position='bottom')
drifters<-filter(hplot,abs(post.saccade.drift)>10,abs(post.saccade.head)>10)
drifters %>%
group_by(block) %>%
tally()->
driftcount
ggplot(driftcount,aes(block,n))+
geom_bar(stat='identity')
drifters<-filter(hplot,abs(post.saccade.drift)>10,abs(post.saccade.head)>10)
drifters %>%
group_by(block) %>%
tally()->
driftcount
ggplot(driftcount,aes(block,n,color=subject))+
geom_bar(stat='identity')
names(hplot)
drifters<-filter(hplot,abs(post.saccade.drift)>10,abs(post.saccade.head)>10)
drifters %>%
group_by(subject,block) %>%
tally()->
driftcount
ggplot(driftcount,aes(block,n,color=subject))+
geom_bar(stat='identity')
drifters<-filter(hplot,abs(post.saccade.drift)>10,abs(post.saccade.head)>10)
drifters %>%
group_by(subject,block) %>%
tally()->
driftcount
ggplot(driftcount,aes(block,n,fill=subject))+
geom_bar(stat='identity')
h<-readRDS('DriftTest1.RDS')
h %>%
mutate(blocknum=as.factor(str_sub(block,7)))%>%
filter(!is.na(trialnum)) %>%
group_by(task,subject,block,blocknum,trialnum) %>%
do(measureTrial(.))->
hm
hplot<-filter(hm,missing.gs<5)
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<5))+
facet_wrap(~block,ncol=4)+
geom_vline(xintercept = -1)+
xlab('VOR gain')
ggplot(filter(hplot,abs(post.saccade.VOR)<3,))+
geom_boxplot(aes(blocknum,post.saccade.VOR,fill=block))+
facet_wrap(~subject,scales='free',ncol=3)+
geom_hline(yintercept = -1,color='red',alpha=0.5)+
theme(legend.position='none')
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=blocknum))+
geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)+
facet_wrap(~subject,ncol=2,scales='free')+
theme(legend.position='none')
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=blocknum))+
geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)+
facet_wrap(~subject,ncol=4,scales='free')+
theme(legend.position='bottom')
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=blocknum))+
geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)+
facet_wrap(~subject,ncol=4,scales='free')+
theme(legend.position='bottom')
ggplot(filter(hplot,abs(post.saccade.head)>10),aes(post.saccade.head,post.saccade.eye,color=blocknum))+
# geom_point()+
geom_abline(slope=-1)+
stat_smooth(method='lm',se=FALSE)+
facet_wrap(~subject,ncol=4,scales='free')+
theme(legend.position='bottom')
drifters<-filter(hplot,abs(post.saccade.drift)>10,abs(post.saccade.head)>10)
drifters %>%
group_by(subject,block) %>%
tally()->
driftcount
ggplot(driftcount,aes(blocknum,n,fill=subject))+
geom_bar(stat='identity')
drifters<-filter(hplot,abs(post.saccade.drift)>10,abs(post.saccade.head)>10)
drifters %>%
group_by(subject,blocknum) %>%
tally()->
driftcount
ggplot(driftcount,aes(blocknum,n,fill=subject))+
geom_bar(stat='identity')
ggplot(driftcount,aes(blocknum,n,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject)
ggplot(driftcount,aes(blocknum,n,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free')
ggplot(driftcount,aes(blocknum,n,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')
ggplot(driftcount,aes(blocknum,n,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Number of Trials with Post-saccadic Drift')
ggplot(driftcount,aes(blocknum,n,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Number of Trials with Post-saccadic Drift')+
theme(legend.position = 'none')
hplot %>%
group_by(subject,blocknum) %>%
summarize(total_n=n()) %>%
left_join(driftcount)->
alldriftcount
head(alldriftcount)
hplot %>%
group_by(subject,blocknum) %>%
summarize(total_n=n()) %>%
left_join(driftcount) %>%
mutate(driftpercent=n/total_n)->
alldriftcount
head(alldriftcount)
ggplot(driftcount,aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
labs(caption='Trials with missing data omitted')
ggplot(alldriftcount,aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
labs(caption='Trials with missing data omitted')
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<5))+
facet_wrap(~block,ncol=3)+
geom_vline(xintercept = -1)+
xlab('VOR gain')
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<3))+
facet_wrap(~block,ncol=3)+
geom_vline(xintercept = -1)+
xlab('VOR gain')
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<3))+
facet_wrap(~block,ncol=3,scales='free')+
geom_vline(xintercept = -1)+
xlab('VOR gain')
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<3))+
facet_wrap(~block,ncol=3,scales='free')+
geom_vline(xintercept = -1)+
xlab('VOR gain')
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<3))+
facet_wrap(~block,ncol=3,scales='free')+
geom_vline(xintercept = -1)+
xlab('VOR gain')
qplot(post.saccade.VOR,binwidth=.1,data=filter(hplot,abs(post.saccade.VOR)<3))+
facet_wrap(~block,ncol=3,scales='free')+
geom_vline(xintercept = -1)+
xlab('VOR gain')
ggboxplot( hplot, x = "blocknum", y=post.saccade.VOR),
library(ggpubr)
ggboxplot( hplot, x = "blocknum", y=post.saccade.VOR),
ggboxplot( hplot, x = "blocknum", y=post.saccade.VOR,
color = "blocknum", palette = "jco",
add = "jitter",
# facet.by = c("subject","amp.bins.15"), short.panel.labs = TRUE)
facet.by = c("subject"), short.panel.labs = TRUE)
ggboxplot(hplot, x = "blocknum", y=post.saccade.VOR,
color = "blocknum", palette = "jco",
add = "jitter",
# facet.by = c("subject","amp.bins.15"), short.panel.labs = TRUE)
facet.by = c("subject"), short.panel.labs = TRUE)
ggboxplot(hplot, x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
add = "jitter",
# facet.by = c("subject","amp.bins.15"), short.panel.labs = TRUE)
facet.by = c("subject"), short.panel.labs = TRUE)
ggboxplot(hplot, x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
add = "jitter",
# facet.by = c("subject","amp.bins.15"), short.panel.labs = TRUE)
facet.by = c("subject"), short.panel.labs = TRUE)+
facet_wrap(scales='free')
ggboxplot(hplot, x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
add = "jitter",
facet.by = c("subject"), )+
ggboxplot(hplot, x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
add = "jitter",
facet.by = c("subject"))+
ggboxplot(hplot, x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
add = "jitter",
facet.by = c("subject"))
ggboxplot(hplot, x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
add = "jitter",
facet.by = c("subject"))
ggboxplot(hplot, x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
facet.by = c("subject"))
ggboxplot(filter(abs(hplot,post.saccade.VOR)<5, x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
facet.by = c("subject"))
ggboxplot(filter(hplot,abs(post.saccade.VOR)<5, x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
facet.by = c("subject"))
ggboxplot(filter(hplot,abs(post.saccade.VOR)<5),
x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
facet.by = c("subject"))
ggboxplot(filter(hplot,abs(post.saccade.VOR)<5),
x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
facet.by = c("subject"),scales='free')
ggboxplot(filter(hplot,abs(post.saccade.VOR)<5),
x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
facet.by = c("subject"),scales='free')+
stat_compare_means(label="p.signif")
ggboxplot(filter(hplot,abs(post.saccade.VOR)<5),
x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
facet.by = c("subject"),scales='free')+
# stat_compare_means(label="p.signif")+
stat_compare_means()
hplot %>%
filter(hplot,abs(post.saccade.VOR)<5) %>%
group_by(subject,blocknum) %>%
summarize(mean.VOR.gain=mean(post.saccade.VOR))->
gaintab
hplot %>%
filter(abs(post.saccade.VOR)<5) %>%
group_by(subject,blocknum) %>%
summarize(mean.VOR.gain=mean(post.saccade.VOR))->
gaintab
kable(gaintab)
library(knitr)
kable(gaintab)
ggplot(filter(hplot,abs(post.saccade.VOR)<3))+
geom_boxplot(aes(blocknum,post.saccade.VOR,fill=block))+
facet_wrap(~subject,scales='free',ncol=3)+
geom_hline(yintercept = -1,color='red',alpha=0.5)+
theme(legend.position='none')
ggboxplot(filter(hplot,abs(post.saccade.VOR)<5),
x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
facet.by = c("subject"),scales='free')+
# stat_compare_means(label="p.signif")+
stat_compare_means()
hplot %>%
filter(abs(post.saccade.VOR)<5) %>%
group_by(subject,blocknum) %>%
summarize(mean.VOR.gain=mean(post.saccade.VOR))->
gaintab
kable(gaintab)
alldriftcount
ggplot(driftcount,aes(blocknum,n,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Number of Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
labs(caption='Trials with missing data omitted')
ggboxplot(filter(hplot,abs(post.saccade.VOR)<5),
x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
facet.by = c("subject"),scales='free',ncol=3)+
# stat_compare_means(label="p.signif")+
stat_compare_means()
