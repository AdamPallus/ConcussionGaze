stat_compare_means()+
theme(legend.position='none')+
xlab('Time Point')+
ylab('Post-saccade VOR gain')
hplot %>%
filter(abs(post.saccade.VOR)<5,
control,
blocknum<3) %>%
ggboxplot(x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
facet.by = c("subject"),scales='free_x',ncol=3)+
# stat_compare_means(label="p.signif")+
stat_compare_means()+
theme(legend.position='none')+
xlab('Time Point')+
ylab('Post-saccade VOR gain')
hplotAdjusted<- rbind(hplotconc,filter(hplot,control))
hplotAdjusted %>%
filter(abs(post.saccade.VOR)<5) %>%
group_by(subject,blocknum) %>%
summarize(median.VOR.gain=mean(post.saccade.VOR))->
gaintab
hplotAdjusted<- rbind(hplotconc,ungroup(filter(hplot,control)))
hplotAdjusted %>%
filter(abs(post.saccade.VOR)<5) %>%
group_by(subject,blocknum) %>%
summarize(median.VOR.gain=mean(post.saccade.VOR))->
gaintab
kable(gaintab)
write.csv(gaintab,'VORmedians.csv')
drifters<-filter(hplotAdjusted,abs(post.saccade.drift)>10,abs(post.saccade.head)>10)
drifters %>%
group_by(subject,blocknum) %>%
tally()->
driftcount
hplot %>%
group_by(subject,blocknum) %>%
summarize(total_n=n()) %>%
left_join(driftcount) %>%
mutate(driftpercent=n/total_n)->
alldriftcount
drifters %>%
group_by(subject,blocknum,control) %>%
tally()->
driftcount
hplotAdjusted %>%
group_by(subject,blocknum,control) %>%
summarize(total_n=n()) %>%
left_join(driftcount) %>%
mutate(driftpercent=n/total_n)->
alldriftcount
ggpaired(alldriftcount,x='blocknum',y='driftpercent',
palette = 'npg',color='blocknum',line.color = "gray", line.size = 0.4)
ggpaired(alldriftcount,x='blocknum',y='driftpercent',
palette = 'npg',color='blocknum',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Post-Saccade VOR Gain')
ggpaired(alldriftcount,x='blocknum',y='driftpercent',
palette = 'npg',fill='blocknum',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Post-Saccade VOR Gain')+
theme(legend.position='none')
alldriftcount %>%
spread(key = blocknum,value=mean.gaze.velocity)->
ss
library(tidyr)
library(tidyr)
alldriftcount %>%
spread(key = blocknum,value=driftpercent)->
ss
ggpaired(ss,cond1='1',cond2='2',facet='control',
palette = 'npg',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Post-Saccade VOR Gain')+
ggpaired(alldriftcount,x='blocknum',y='driftpercent',
palette = 'npg',fill='blocknum',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Post-Saccade VOR Gain')+
theme(legend.position='none')
ss
alldriftcount %>%
spread(key = blocknum,value=driftpercent)->
ss
ss
alldriftcount %>%
ungroup() %>%
spread(key = blocknum,value=driftpercent)->
ss
ss
ggpaired(ss,cond1='1',cond2='2',facet='control',
palette = 'npg',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Post-Saccade VOR Gain')+
ggpaired(alldriftcount,x='blocknum',y='driftpercent',facet='control'
palette = 'npg',fill='blocknum',line.color = "gray", line.size = 0.4)+
ggpaired(alldriftcount,x='blocknum',y='driftpercent',facet='control'
palette = 'npg',fill='blocknum',line.color = "gray", line.size = 0.4)+
ggpaired(alldriftcount,x='blocknum',y='driftpercent',facet='control',
palette = 'npg',fill='blocknum',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Post-Saccade VOR Gain')+
theme(legend.position='none')
alldriftcount
alldriftcount<-ungroup(alldriftcount)
ggpaired(alldriftcount,x='blocknum',y='driftpercent',facet='control',
palette = 'npg',fill='blocknum',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Post-Saccade VOR Gain')+
theme(legend.position='none')
ggpaired(alldriftcount,x='blocknum',y='driftpercent',facet='control',
group='subject',
palette = 'npg',fill='blocknum',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Post-Saccade VOR Gain')+
theme(legend.position='none')
spread(driftcount,key=blocknum,value=n)
alldriftcount %>%
select(-n) %>%
ungroup() %>%
spread(key = blocknum,value=driftpercent)->
ss
ss
alldriftcount %>%
select(-n,-total_n) %>%
ungroup() %>%
spread(key = blocknum,value=driftpercent)->
ss
ss
ggpaired(ss,cond1='1',cond2='2',facet='control',
palette = 'npg',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Post-Saccade VOR Gain')
levels(alldriftcount$concussed)<-c('Concussed','Control')
levels(alldriftcount$control)
alldriftcount$control<- as.factor(alldriftcount$control)
levels(alldriftcount$concussed)<-c('Concussed','Control')
levels(alldriftcount$control)
levels(alldriftcount$control)<-c('Concussed','Control')
alldriftcount %>%
select(-n,-total_n) %>%
ungroup() %>%
spread(key = blocknum,value=driftpercent)->
ss
ss
ggpaired(ss,cond1='1',cond2='2',facet='control',
palette = 'npg',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Percentage of Trials with post-saccadic drift')
wilcox.test(ss)
?wilcox.test
wilcox.test(ss[['1']])
wilcox.test(alldriftcount[['1']])
wilcox.test(ss[['1']],ss[['2']])
ggpaired(alldriftcount,x='blocknum',y='driftpercent'
palette = 'npg',fill='blocknum',line.color = "gray", line.size = 0.4)+
ggpaired(alldriftcount,x='blocknum',y='driftpercent',
palette = 'npg',fill='blocknum',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Post-Saccade VOR Gain')+
theme(legend.position='none')
ggpaired(ss,cond1='1',cond2='2',
palette = 'npg',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Percentage of Trials with post-saccadic drift')
ggpaired(ss,cond1='1',cond2='2',facet='control',
palette = 'npg',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Percentage of Trials with post-saccadic drift')
ssc<-filter(ss,control=='Concussed')
wilcox.test(ssc[['1']],ssc[['2']])
palette = 'jco',line.color = "gray", line.size = 0.4)+
ggpaired(ss,cond1='1',cond2='2',facet='control',color='blocknum'
palette = 'jco',line.color = "gray", line.size = 0.4)+
ggpaired(ss,cond1='1',cond2='2',facet='control',color='blocknum',
palette = 'jco',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Percentage of Trials with post-saccadic drift')
names(ss)
ggpaired(ss,cond1='1',cond2='2',facet='control',
palette = 'jco',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Percentage of Trials with post-saccadic drift')
ggpaired(ss,cond1='1',cond2='2',facet='control',
palette = 'jco',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Percentage of Trials with post-saccadic drift')
ggpaired(alldriftcount,x='blocknum',y='driftpercent*100',facet='control',
palette = 'npg',fill='blocknum',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Post-Saccade VOR Gain')+
theme(legend.position='none')
ggpaired(alldriftcount,x='blocknum',y='driftpercent*100',facet='control',
palette = 'npg',fill='blocknum',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Post-Saccade VOR Gain')+
theme(legend.position='none')
ggpaired(ss,cond1='1',cond2='2',facet='control',
palette = 'jco',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Fraction of Trials with post-saccadic drift')
ggpaired(ss,cond1='1',cond2='2',facet='control',
palette = 'jco',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Fraction of Trials with post-saccadic drift')
ggpaired(ss,cond1='1',cond2='2',facet='control',color='subject',
palette = 'jco',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Fraction of Trials with post-saccadic drift')
ggpaired(ss,cond1='1',cond2='2',facet='control',color='subject',
palette = 'jco',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Fraction of Trials with post-saccadic drift')
ggpaired(ss,cond1='1',cond2='2',facet='control',point.color='subject',
palette = 'jco',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Fraction of Trials with post-saccadic drift')
ggpaired(ss,cond1='1',cond2='2',facet='control',point.color='subject',
palette = 'jco',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Fraction of Trials with post-saccadic drift')
?ggpaired
ggpaired(ss,cond1='1',cond2='2',facet='control',point.color='subject',
palette = 'jco',line.color = "subject", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Fraction of Trials with post-saccadic drift')
ggpaired(ss,cond1='1',cond2='2',facet='control',
palette = 'jco',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Fraction of Trials with post-saccadic drift')
alldriftcount
ggplot(alldriftcount,aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
labs(caption='Trials with missing data omitted')
ggplot(alldriftcount,aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
labs(caption='Trials with missing data omitted')
ggplot(alldriftcount,aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
labs(caption='Trials with missing data omitted')+
theme(minimal())
ggplot(alldriftcount,aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
labs(caption='Trials with missing data omitted')+
theme_minimal()
ggplot(alldriftcount,aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x',ncol=3)+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
labs(caption='Trials with missing data omitted')+
theme_minimal()
ggplot(alldriftcount,aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_grid(control~subject,scales='free_x',ncol=3)+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
labs(caption='Trials with missing data omitted')+
theme_minimal()
ggplot(alldriftcount,aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_grid(control~subject,scales='free_x')+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
labs(caption='Trials with missing data omitted')+
theme_minimal()
ggplot(alldriftcount,aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~interact(control,subject),scales='free_x',ncol=3)+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
labs(caption='Trials with missing data omitted')+
theme_minimal()
ggplot(alldriftcount,aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~intersect(control,subject),scales='free_x',ncol=3)+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
labs(caption='Trials with missing data omitted')+
theme_minimal()
alldriftcount %>%
filter(control) %>%
ggplot(aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
theme_minimal()
alldriftcount
alldriftcount %>%
filter(control=='Control') %>%
ggplot(aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme(legend.position = 'none')+
theme_minimal()
alldriftcount %>%
filter(control=='Control') %>%
ggplot(aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme_minimal()+
theme(legend.position = 'none')
alldriftcount %>%
filter(control=='Concussed') %>%
ggplot(aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme_minimal()+
theme(legend.position = 'none')
alldriftcount %>%
filter(control=='Concussed') %>%
ggplot(aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Percentage of Good Trials with Post-saccadic Drift')+
theme_minimal()+
theme(legend.position = 'none')+
xlab('Time Point')
alldriftcount %>%
filter(control=='Control') %>%
ggplot(aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Fraction of Good Trials with Post-saccadic Drift')+
theme_minimal()+
theme(legend.position = 'none')+
xlab('Time Point')
alldriftcount %>%
filter(control=='Control') %>%
ggplot(aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Fraction of Good Trials with Post-saccadic Drift')+
theme_minimal()+
theme(legend.position = 'none')+
xlab('Time Point')
alldriftcount %>%
filter(control=='Control') %>%
ggplot(aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Fraction of Good Trials with Post-saccadic Drift')+
theme_minimal()+
theme(legend.position = 'none')+
xlab('Time Point')+
ggtitle('Control Subjects')
alldriftcount %>%
filter(control=='Control') %>%
ggplot(aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Fraction of Good Trials with Post-saccadic Drift')+
theme_minimal()+
theme(legend.position = 'none')+
xlab('Time Point')+
ggtitle('Control Subjects')
alldriftcount %>%
filter(control=='Concussed') %>%
ggplot(aes(blocknum,driftpercent,fill=subject))+
geom_bar(stat='identity')+
facet_wrap(~subject,scales='free_x')+
ylab('Fraction of Good Trials with Post-saccadic Drift')+
theme_minimal()+
theme(legend.position = 'none')+
xlab('Time Point')
names(alldriftcount)
alldriftcount %>%
mutate(post.block=control=='Concussed' & blocknum == '2')->
alldriftcount
ggpaired(alldriftcount,x='blocknum',y='driftpercent*100',facet='post.block',
palette = 'npg',fill='blocknum',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Post-Saccade VOR Gain')+
theme(legend.position='none')
ggpaired(alldriftcount,x='blocknum',y='driftpercent*100',
palette = 'npg',color='post.block',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Percentage of Trials with Post-Saccadic Drift')+
theme(legend.position='none')
ggpaired(alldriftcount,x='post.block',y='driftpercent*100',
palette = 'npg',color='post.block',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Percentage of Trials with Post-Saccadic Drift')+
theme(legend.position='none')
ggboxplot(alldriftcount,x='post.block',y='driftpercent*100',
palette = 'rickandmorty',color='post.block')+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Percentage of Trials with Post-Saccadic Drift')+
theme(legend.position='none')
ggboxplot(alldriftcount,x='post.block',y='driftpercent*100',
palette = 'simpsons',color='post.block')+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Percentage of Trials with Post-Saccadic Drift')+
theme(legend.position='none')
ggboxplot(alldriftcount,x='post.block',y='driftpercent*100',
palette = 'lancet',color='post.block')+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Percentage of Trials with Post-Saccadic Drift')+
theme(legend.position='none')
ggboxplot(alldriftcount,x='post.block',y='driftpercent*100',
palette = 'lancet',color='post.block')+
stat_compare_means()+
xlab('Time Point')+
ylab('Percentage of Trials with Post-Saccadic Drift')+
theme(legend.position='none')
ggboxplot(alldriftcount,x='post.block',y='driftpercent*100',
palette = 'jco',color='post.block')+
stat_compare_means()+
xlab('Time Point')+
ylab('Percentage of Trials with Post-Saccadic Drift')+
theme(legend.position='none')
levels(post.block)
levels(alldriftcount$post.block)
alldriftcount$post.block<-as.factor(alldriftcount$post.block)
levels(alldriftcount$post.block)
levels(alldriftcount$post.block)<-c('Control and Pre-concussion','Post-concussion')
ggpaired(alldriftcount,x='post.block',y='driftpercent*100',
palette = 'npg',color='post.block',line.color = "gray", line.size = 0.4)+
stat_compare_means(paired=TRUE)+
xlab('Time Point')+
ylab('Percentage of Trials with Post-Saccadic Drift')+
theme(legend.position='none')
ggboxplot(alldriftcount,x='post.block',y='driftpercent*100',
palette = 'lancet',color='post.block')+
stat_compare_means()+
xlab('Time Point')+
ylab('Percentage of Trials with Post-Saccadic Drift')+
theme(legend.position='none')
ggboxplot(alldriftcount,x='post.block',y='driftpercent*100',
palette = 'lancet',color='post.block')+
stat_compare_means()+
xlab('Time Point')+
ylab('Percentage of Trials with Post-Saccadic Drift')+
theme(legend.position='none')
?geom_boxplot
hplotAdjusted %>%
filter(abs(post.saccade.VOR)<5) %>%
ggboxplot(x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
facet.by = c("subject"),scales='free_x',ncol=3)+
# stat_compare_means(label="p.signif")+
stat_compare_means()+
theme(legend.position='none')+
xlab('Time Point')+
ylab('Post-saccade VOR gain')
hplotAdjusted %>%
filter(abs(post.saccade.VOR)<5) %>%
ggboxplot(x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
facet.by = c("subject"),scales='free_x',ncol=3)+
# stat_compare_means(label="p.signif")+
stat_compare_means()+
theme(legend.position='none')+
xlab('Time Point')+
ylab('Post-saccade VOR gain')
hplotAdjusted %>%
filter(abs(post.saccade.VOR)<5) %>%
ggboxplot(x = "blocknum", y="post.saccade.VOR",
color = "blocknum", palette = "jco",
facet.by = c("subject"),scales='free_x',ncol=3)+
# stat_compare_means(label="p.signif")+
stat_compare_means()+
theme(legend.position='none')+
xlab('Time Point')+
ylab('Post-saccade VOR gain')+geom_hline(yintercept = -1)
